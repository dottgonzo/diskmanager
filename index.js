var execSync = require("sync-exec");
module.exports = { device: function (device) {
        var cmd = "fdisk " + device + " -l";
        var fdi = execSync(cmd).stdout.split("\n");
        var disks = [];
        for (var i = 0; i < fdi.length; i++) {
            var line = fdi[i].replace(/ +(?= )/g, "").split(" ");
            if (fdi[i].split("/dev/ram").length < 2 && fdi[i].split("isk /").length > 1) {
                var disk = line[1].replace(":", "");
                var sectors = parseInt(line[6]);
                var size = parseInt(line[4]);
                disks.push({ disk: disk, sectors: sectors, size: size, partitions: [], block: 512 });
            }
            else if (disks[0] && fdi[i].split(":").length < 2 && fdi[i].split("dev/").length > 1 && line.length > 1) {
                var partition = line[0];
                var boot = void 0;
                var sector_start = void 0;
                var sector_stop = void 0;
                var sectors = void 0;
                var type = "";
                var typeId = void 0;
                if (line[1] === "*") {
                    boot = true;
                    sector_start = parseInt(line[2]);
                    sector_stop = parseInt(line[3]);
                    sectors = parseInt(line[4]);
                    typeId = parseInt(line[6]);
                    for (var l = 7; l < line.length; l++) {
                        if (l === line.length - 1) {
                            type = type + line[l];
                        }
                        else {
                            type = type + line[l] + " ";
                        }
                    }
                }
                else {
                    boot = false;
                    sector_start = parseInt(line[1]);
                    sector_stop = parseInt(line[2]);
                    sectors = parseInt(line[3]);
                    typeId = parseInt(line[5]);
                    for (var l = 6; l < line.length; l++) {
                        if (l === line.length - 1) {
                            type = type + line[l];
                        }
                        else {
                            type = type + line[l] + " ";
                        }
                    }
                }
                var size = disks[disks.length - 1].block * sectors;
                disks[disks.length - 1].partitions.push({ partition: partition, sectors_start: sector_start, sectors_stop: sector_stop, sectors: sectors, size: size, type: type, boot: boot });
            }
            else if (disks[0] && line[0] === "Units:") {
                disks[disks.length - 1].block = parseInt(line[5]);
            }
        }
        return disks[0];
    },
    all: function () {
        var cmd = "fdisk -l";
        var fdi = execSync(cmd).stdout.split("\n");
        var disks = [];
        for (var i = 0; i < fdi.length; i++) {
            var line = fdi[i].replace(/ +(?= )/g, "").split(" ");
            if (fdi[i].split("/dev/ram").length < 2 && fdi[i].split("isk /").length > 1) {
                var disk = line[1].replace(":", "");
                var sectors = parseInt(line[6]);
                var size = parseInt(line[4]);
                disks.push({ disk: disk, sectors: sectors, size: size, partitions: [], block: 512 });
            }
            else if (disks[0] && fdi[i].split(":").length < 2 && fdi[i].split("dev/").length > 1 && line.length > 1) {
                var partition = line[0];
                var boot = void 0;
                var sector_start = void 0;
                var sector_stop = void 0;
                var sectors = void 0;
                var type = "";
                var typeId = void 0;
                if (line[1] === "*") {
                    boot = true;
                    sector_start = parseInt(line[2]);
                    sector_stop = parseInt(line[3]);
                    sectors = parseInt(line[4]);
                    typeId = parseInt(line[6]);
                    for (var l = 7; l < line.length; l++) {
                        if (l === line.length - 1) {
                            type = type + line[l];
                        }
                        else {
                            type = type + line[l] + " ";
                        }
                    }
                }
                else {
                    boot = false;
                    sector_start = parseInt(line[1]);
                    sector_stop = parseInt(line[2]);
                    sectors = parseInt(line[3]);
                    typeId = parseInt(line[5]);
                    for (var l = 6; l < line.length; l++) {
                        if (l === line.length - 1) {
                            type = type + line[l];
                        }
                        else {
                            type = type + line[l] + " ";
                        }
                    }
                }
                var size = disks[disks.length - 1].block * sectors;
                disks[disks.length - 1].partitions.push({ partition: partition, sectors_start: sector_start, sectors_stop: sector_stop, sectors: sectors, size: size, type: type, boot: boot });
            }
            else if (disks[0] && line[0] === "Units:") {
                disks[disks.length - 1].block = parseInt(line[5]);
            }
        }
        return disks;
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbImRldmljZSIsImFsbCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBd0JwQyxpQkFBUyxFQUFDLE1BQU0sWUFBQyxNQUFjO1FBQzNCQSxJQUFJQSxHQUFHQSxHQUFHQSxRQUFRQSxHQUFHQSxNQUFNQSxHQUFHQSxLQUFLQSxDQUFDQTtRQUVwQ0EsSUFBSUEsR0FBR0EsR0FBR0EsUUFBUUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDM0NBLElBQUlBLEtBQUtBLEdBQVlBLEVBQUVBLENBQUNBO1FBQ3hCQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxHQUFHQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQSxFQUFFQSxFQUFFQSxDQUFDQTtZQUNsQ0EsSUFBSUEsSUFBSUEsR0FBYUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsVUFBVUEsRUFBRUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDL0RBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLFVBQVVBLENBQUNBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLElBQUlBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUUxRUEsSUFBSUEsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsRUFBRUEsRUFBRUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ3BDQSxJQUFJQSxPQUFPQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDaENBLElBQUlBLElBQUlBLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUM3QkEsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsT0FBT0EsRUFBRUEsT0FBT0EsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsVUFBVUEsRUFBZ0JBLEVBQUVBLEVBQUVBLEtBQUtBLEVBQUVBLEdBQUdBLEVBQUVBLENBQUNBLENBQUNBO1lBQ3ZHQSxDQUFDQTtZQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFFeEdBLElBQUlBLFNBQVNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUN4QkEsSUFBSUEsSUFBSUEsU0FBQUEsQ0FBQ0E7Z0JBQ1RBLElBQUlBLFlBQVlBLFNBQUFBLENBQUNBO2dCQUNqQkEsSUFBSUEsV0FBV0EsU0FBQUEsQ0FBQ0E7Z0JBQ2hCQSxJQUFJQSxPQUFPQSxTQUFBQSxDQUFDQTtnQkFFWkEsSUFBSUEsSUFBSUEsR0FBR0EsRUFBRUEsQ0FBQ0E7Z0JBQ2RBLElBQUlBLE1BQU1BLFNBQUFBLENBQUNBO2dCQUVYQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDbEJBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBO29CQUNaQSxZQUFZQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDakNBLFdBQVdBLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO29CQUNoQ0EsT0FBT0EsR0FBR0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQzVCQSxNQUFNQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDM0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO3dCQUNuQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7NEJBQ3hCQSxJQUFJQSxHQUFHQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTt3QkFDMUJBLENBQUNBO3dCQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTs0QkFDSkEsSUFBSUEsR0FBR0EsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0E7d0JBQ2hDQSxDQUFDQTtvQkFDTEEsQ0FBQ0E7Z0JBRUxBLENBQUNBO2dCQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtvQkFDSkEsSUFBSUEsR0FBR0EsS0FBS0EsQ0FBQ0E7b0JBQ2JBLFlBQVlBLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO29CQUNqQ0EsV0FBV0EsR0FBR0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ2hDQSxPQUFPQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDNUJBLE1BQU1BLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO29CQUMzQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0E7d0JBQ25DQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTs0QkFDeEJBLElBQUlBLEdBQUdBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO3dCQUMxQkEsQ0FBQ0E7d0JBQUNBLElBQUlBLENBQUNBLENBQUNBOzRCQUNKQSxJQUFJQSxHQUFHQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxDQUFDQTt3QkFDaENBLENBQUNBO29CQUNMQSxDQUFDQTtnQkFDTEEsQ0FBQ0E7Z0JBQ0RBLElBQUlBLElBQUlBLEdBQUdBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLEdBQUdBLE9BQU9BLENBQUNBO2dCQUNuREEsS0FBS0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsU0FBU0EsRUFBRUEsU0FBU0EsRUFBRUEsYUFBYUEsRUFBRUEsWUFBWUEsRUFBRUEsWUFBWUEsRUFBRUEsV0FBV0EsRUFBRUEsT0FBT0EsRUFBRUEsT0FBT0EsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsQ0FBQ0EsQ0FBQ0E7WUFDcExBLENBQUNBO1lBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBO2dCQUMxQ0EsS0FBS0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsR0FBR0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDdERBLENBQUNBO1FBQ0xBLENBQUNBO1FBRURBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO0lBRXBCQSxDQUFDQTtJQUVELEdBQUc7UUFFS0MsSUFBSUEsR0FBR0EsR0FBR0EsVUFBVUEsQ0FBQ0E7UUFDekJBLElBQUlBLEdBQUdBLEdBQUdBLFFBQVFBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1FBQzNDQSxJQUFJQSxLQUFLQSxHQUFZQSxFQUFFQSxDQUFDQTtRQUN4QkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0E7WUFDbENBLElBQUlBLElBQUlBLEdBQWFBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLFVBQVVBLEVBQUVBLEVBQUVBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1lBQy9EQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxVQUFVQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFFMUVBLElBQUlBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLEdBQUdBLEVBQUVBLEVBQUVBLENBQUNBLENBQUNBO2dCQUNwQ0EsSUFBSUEsT0FBT0EsR0FBR0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ2hDQSxJQUFJQSxJQUFJQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDN0JBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLE9BQU9BLEVBQUVBLE9BQU9BLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLFVBQVVBLEVBQWdCQSxFQUFFQSxFQUFFQSxLQUFLQSxFQUFFQSxHQUFHQSxFQUFFQSxDQUFDQSxDQUFDQTtZQUN2R0EsQ0FBQ0E7WUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBRXhHQSxJQUFJQSxTQUFTQSxHQUFH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QUFHQSxLQUFLQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxHQUFHQSxPQUFPQSxDQUFDQTtnQkFDbkRBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLEVBQUVBLFNBQVNBLEVBQUVBLFNBQVNBLEVBQUVBLGFBQWFBLEVBQUVBLFlBQVlBLEVBQUVBLFlBQVlBLEVBQUVBLFdBQVdBLEVBQUVBLE9BQU9BLEVBQUVBLE9BQU9BLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLENBQUNBLENBQUNBO1lBQ3BMQSxDQUFDQTtZQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDMUNBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ3REQSxDQUFDQTtRQUNMQSxDQUFDQTtRQUVEQSxNQUFNQSxDQUFDQSxLQUFLQSxDQUFDQTtJQUNqQkEsQ0FBQ0E7Q0FDQSxDQUFBIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IGV4ZWNTeW5jID0gcmVxdWlyZShcInN5bmMtZXhlY1wiKTtcblxuXG5pbnRlcmZhY2UgSVBhcnRpdGlvbiB7XG4gICAgcGFydGl0aW9uOiBzdHJpbmc7XG4gICAgc2VjdG9yczogbnVtYmVyO1xuICAgIHNlY3RvcnNfc3RhcnQ6IG51bWJlcjtcbiAgICBzZWN0b3JzX3N0b3A6IG51bWJlcjtcbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgYm9vdDogYm9vbGVhbjtcbiAgICBzaXplOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBJRGlzayB7XG4gICAgZGlzazogc3RyaW5nO1xuICAgIHNlY3RvcnM6IG51bWJlcjtcbiAgICBzaXplOiBudW1iZXI7XG4gICAgcGFydGl0aW9uczogSVBhcnRpdGlvbltdO1xuICAgIGJsb2NrOiBudW1iZXI7XG59XG5cblxuXG5cbmV4cG9ydCA9IHtkZXZpY2UoZGV2aWNlOiBzdHJpbmcpIHtcbiAgICBsZXQgY21kID0gXCJmZGlzayBcIiArIGRldmljZSArIFwiIC1sXCI7XG5cbiAgICBsZXQgZmRpID0gZXhlY1N5bmMoY21kKS5zdGRvdXQuc3BsaXQoXCJcXG5cIik7XG4gICAgbGV0IGRpc2tzID0gPElEaXNrW10+W107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmZGkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGxpbmU6IHN0cmluZ1tdID0gZmRpW2ldLnJlcGxhY2UoLyArKD89ICkvZywgXCJcIikuc3BsaXQoXCIgXCIpO1xuICAgICAgICBpZiAoZmRpW2ldLnNwbGl0KFwiL2Rldi9yYW1cIikubGVuZ3RoIDwgMiAmJiBmZGlbaV0uc3BsaXQoXCJpc2sgL1wiKS5sZW5ndGggPiAxKSB7XG5cbiAgICAgICAgICAgIGxldCBkaXNrID0gbGluZVsxXS5yZXBsYWNlKFwiOlwiLCBcIlwiKTtcbiAgICAgICAgICAgIGxldCBzZWN0b3JzID0gcGFyc2VJbnQobGluZVs2XSk7XG4gICAgICAgICAgICBsZXQgc2l6ZSA9IHBhcnNlSW50KGxpbmVbNF0pO1xuICAgICAgICAgICAgZGlza3MucHVzaCh7IGRpc2s6IGRpc2ssIHNlY3RvcnM6IHNlY3RvcnMsIHNpemU6IHNpemUsIHBhcnRpdGlvbnM6IDxJUGFydGl0aW9uW10+W10sIGJsb2NrOiA1MTIgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGlza3NbMF0gJiYgZmRpW2ldLnNwbGl0KFwiOlwiKS5sZW5ndGggPCAyICYmIGZkaVtpXS5zcGxpdChcImRldi9cIikubGVuZ3RoID4gMSAmJiBsaW5lLmxlbmd0aCA+IDEpIHtcblxuICAgICAgICAgICAgbGV0IHBhcnRpdGlvbiA9IGxpbmVbMF07XG4gICAgICAgICAgICBsZXQgYm9vdDtcbiAgICAgICAgICAgIGxldCBzZWN0b3Jfc3RhcnQ7XG4gICAgICAgICAgICBsZXQgc2VjdG9yX3N0b3A7XG4gICAgICAgICAgICBsZXQgc2VjdG9ycztcblxuICAgICAgICAgICAgbGV0IHR5cGUgPSBcIlwiO1xuICAgICAgICAgICAgbGV0IHR5cGVJZDtcblxuICAgICAgICAgICAgaWYgKGxpbmVbMV0gPT09IFwiKlwiKSB7XG4gICAgICAgICAgICAgICAgYm9vdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgc2VjdG9yX3N0YXJ0ID0gcGFyc2VJbnQobGluZVsyXSk7XG4gICAgICAgICAgICAgICAgc2VjdG9yX3N0b3AgPSBwYXJzZUludChsaW5lWzNdKTtcbiAgICAgICAgICAgICAgICBzZWN0b3JzID0gcGFyc2VJbnQobGluZVs0XSk7XG4gICAgICAgICAgICAgICAgdHlwZUlkID0gcGFyc2VJbnQobGluZVs2XSk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbCA9IDc7IGwgPCBsaW5lLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsID09PSBsaW5lLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlICsgbGluZVtsXTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlICsgbGluZVtsXSArIFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJvb3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBzZWN0b3Jfc3RhcnQgPSBwYXJzZUludChsaW5lWzFdKTtcbiAgICAgICAgICAgICAgICBzZWN0b3Jfc3RvcCA9IHBhcnNlSW50KGxpbmVbMl0pO1xuICAgICAgICAgICAgICAgIHNlY3RvcnMgPSBwYXJzZUludChsaW5lWzNdKTtcbiAgICAgICAgICAgICAgICB0eXBlSWQgPSBwYXJzZUludChsaW5lWzVdKTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBsID0gNjsgbCA8IGxpbmUubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGwgPT09IGxpbmUubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IHR5cGUgKyBsaW5lW2xdO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IHR5cGUgKyBsaW5lW2xdICsgXCIgXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgc2l6ZSA9IGRpc2tzW2Rpc2tzLmxlbmd0aCAtIDFdLmJsb2NrICogc2VjdG9ycztcbiAgICAgICAgICAgIGRpc2tzW2Rpc2tzLmxlbmd0aCAtIDFdLnBhcnRpdGlvbnMucHVzaCh7IHBhcnRpdGlvbjogcGFydGl0aW9uLCBzZWN0b3JzX3N0YXJ0OiBzZWN0b3Jfc3RhcnQsIHNlY3RvcnNfc3RvcDogc2VjdG9yX3N0b3AsIHNlY3RvcnM6IHNlY3RvcnMsIHNpemU6IHNpemUsIHR5cGU6IHR5cGUsIGJvb3Q6IGJvb3QgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGlza3NbMF0gJiYgbGluZVswXSA9PT0gXCJVbml0czpcIikge1xuICAgICAgICAgICAgZGlza3NbZGlza3MubGVuZ3RoIC0gMV0uYmxvY2sgPSBwYXJzZUludChsaW5lWzVdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBkaXNrc1swXTtcblxufSxcblxuYWxsKCkge1xuXG4gICAgICAgIGxldCBjbWQgPSBcImZkaXNrIC1sXCI7XG4gICAgbGV0IGZkaSA9IGV4ZWNTeW5jKGNtZCkuc3Rkb3V0LnNwbGl0KFwiXFxuXCIpO1xuICAgIGxldCBkaXNrcyA9IDxJRGlza1tdPltdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmRpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBsaW5lOiBzdHJpbmdbXSA9IGZkaVtpXS5yZXBsYWNlKC8gKyg/PSApL2csIFwiXCIpLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgaWYgKGZkaVtpXS5zcGxpdChcIi9kZXYvcmFtXCIpLmxlbmd0aCA8IDIgJiYgZmRpW2ldLnNwbGl0KFwiaXNrIC9cIikubGVuZ3RoID4gMSkge1xuXG4gICAgICAgICAgICBsZXQgZGlzayA9IGxpbmVbMV0ucmVwbGFjZShcIjpcIiwgXCJcIik7XG4gICAgICAgICAgICBsZXQgc2VjdG9ycyA9IHBhcnNlSW50KGxpbmVbNl0pO1xuICAgICAgICAgICAgbGV0IHNpemUgPSBwYXJzZUludChsaW5lWzRdKTtcbiAgICAgICAgICAgIGRpc2tzLnB1c2goeyBkaXNrOiBkaXNrLCBzZWN0b3JzOiBzZWN0b3JzLCBzaXplOiBzaXplLCBwYXJ0aXRpb25zOiA8SVBhcnRpdGlvbltdPltdLCBibG9jazogNTEyIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGRpc2tzWzBdICYmIGZkaVtpXS5zcGxpdChcIjpcIikubGVuZ3RoIDwgMiAmJiBmZGlbaV0uc3BsaXQoXCJkZXYvXCIpLmxlbmd0aCA+IDEgJiYgbGluZS5sZW5ndGggPiAxKSB7XG5cbiAgICAgICAgICAgIGxldCBwYXJ0aXRpb24gPSBsaW5lWzBdO1xuICAgICAgICAgICAgbGV0IGJvb3Q7XG4gICAgICAgICAgICBsZXQgc2VjdG9yX3N0YXJ0O1xuICAgICAgICAgICAgbGV0IHNlY3Rvcl9zdG9wO1xuICAgICAgICAgICAgbGV0IHNlY3RvcnM7XG5cbiAgICAgICAgICAgIGxldCB0eXBlID0gXCJcIjtcbiAgICAgICAgICAgIGxldCB0eXBlSWQ7XG5cbiAgICAgICAgICAgIGlmIChsaW5lWzFdID09PSBcIipcIikge1xuICAgICAgICAgICAgICAgIGJvb3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNlY3Rvcl9zdGFydCA9IHBhcnNlSW50KGxpbmVbMl0pO1xuICAgICAgICAgICAgICAgIHNlY3Rvcl9zdG9wID0gcGFyc2VJbnQobGluZVszXSk7XG4gICAgICAgICAgICAgICAgc2VjdG9ycyA9IHBhcnNlSW50KGxpbmVbNF0pO1xuICAgICAgICAgICAgICAgIHR5cGVJZCA9IHBhcnNlSW50KGxpbmVbNl0pO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGwgPSA3OyBsIDwgbGluZS5sZW5ndGg7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobCA9PT0gbGluZS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gdHlwZSArIGxpbmVbbF07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gdHlwZSArIGxpbmVbbF0gKyBcIiBcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBib290ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgc2VjdG9yX3N0YXJ0ID0gcGFyc2VJbnQobGluZVsxXSk7XG4gICAgICAgICAgICAgICAgc2VjdG9yX3N0b3AgPSBwYXJzZUludChsaW5lWzJdKTtcbiAgICAgICAgICAgICAgICBzZWN0b3JzID0gcGFyc2VJbnQobGluZVszXSk7XG4gICAgICAgICAgICAgICAgdHlwZUlkID0gcGFyc2VJbnQobGluZVs1XSk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbCA9IDY7IGwgPCBsaW5lLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsID09PSBsaW5lLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlICsgbGluZVtsXTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlICsgbGluZVtsXSArIFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHNpemUgPSBkaXNrc1tkaXNrcy5sZW5ndGggLSAxXS5ibG9jayAqIHNlY3RvcnM7XG4gICAgICAgICAgICBkaXNrc1tkaXNrcy5sZW5ndGggLSAxXS5wYXJ0aXRpb25zLnB1c2goeyBwYXJ0aXRpb246IHBhcnRpdGlvbiwgc2VjdG9yc19zdGFydDogc2VjdG9yX3N0YXJ0LCBzZWN0b3JzX3N0b3A6IHNlY3Rvcl9zdG9wLCBzZWN0b3JzOiBzZWN0b3JzLCBzaXplOiBzaXplLCB0eXBlOiB0eXBlLCBib290OiBib290IH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGRpc2tzWzBdICYmIGxpbmVbMF0gPT09IFwiVW5pdHM6XCIpIHtcbiAgICAgICAgICAgIGRpc2tzW2Rpc2tzLmxlbmd0aCAtIDFdLmJsb2NrID0gcGFyc2VJbnQobGluZVs1XSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZGlza3M7XG59XG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
