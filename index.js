var execSync = require("sync-exec");
function device(device) {
    var cmd = "fdisk " + device + " -l";
    var fdi = execSync(cmd).stdout.split("\n");
    var disks = [];
    for (var i = 0; i < fdi.length; i++) {
        var line = fdi[i].replace(/ +(?= )/g, "").split(" ");
        if (fdi[i].split("/dev/ram").length < 2 && fdi[i].split("isk /").length > 1) {
            var disk = line[1].replace(":", "");
            var sectors = parseInt(line[6]);
            var size = parseInt(line[4]);
            disks.push({ disk: disk, sectors: sectors, size: size, partitions: [], block: 512, used_blocks: null });
        }
        else if (disks[0] && fdi[i].split(":").length < 2 && fdi[i].split("dev/").length > 1 && line.length > 1) {
            var partition = line[0];
            var boot = void 0;
            var sector_start = void 0;
            var sector_stop = void 0;
            var sectors = void 0;
            var type = "";
            var typeId = void 0;
            if (line[1] === "*") {
                boot = true;
                sector_start = parseInt(line[2]);
                sector_stop = parseInt(line[3]);
                sectors = parseInt(line[4]);
                typeId = parseInt(line[6]);
                for (var l = 7; l < line.length; l++) {
                    if (l === line.length - 1) {
                        type = type + line[l];
                    }
                    else {
                        type = type + line[l] + " ";
                    }
                }
            }
            else {
                boot = false;
                sector_start = parseInt(line[1]);
                sector_stop = parseInt(line[2]);
                sectors = parseInt(line[3]);
                typeId = parseInt(line[5]);
                for (var l = 6; l < line.length; l++) {
                    if (l === line.length - 1) {
                        type = type + line[l];
                    }
                    else {
                        type = type + line[l] + " ";
                    }
                }
            }
            var size = disks[disks.length - 1].block * sectors;
            disks[disks.length - 1].partitions.push({ partition: partition, sectors_start: sector_start, sectors_stop: sector_stop, sectors: sectors, size: size, type: type, boot: boot });
        }
        else if (disks[0] && line[0] === "Units:") {
            disks[disks.length - 1].block = parseInt(line[5]);
        }
    }
    disks[0].used_blocks = disks[0].partitions[disks[0].partitions.length - 1].sectors_stop;
    return disks[0];
}
exports.device = device;
function all() {
    var cmd = "fdisk -l";
    var fdi = execSync(cmd).stdout.split("\n");
    var disks = [];
    for (var i = 0; i < fdi.length; i++) {
        var line = fdi[i].replace(/ +(?= )/g, "").split(" ");
        if (fdi[i].split("/dev/ram").length < 2 && fdi[i].split("isk /").length > 1) {
            var disk = line[1].replace(":", "");
            var sectors = parseInt(line[6]);
            var size = parseInt(line[4]);
            disks.push({ disk: disk, sectors: sectors, size: size, partitions: [], block: 512, used_blocks: null });
        }
        else if (disks[0] && fdi[i].split(":").length < 2 && fdi[i].split("dev/").length > 1 && line.length > 1) {
            var partition = line[0];
            var boot = void 0;
            var sector_start = void 0;
            var sector_stop = void 0;
            var sectors = void 0;
            var type = "";
            var typeId = void 0;
            if (line[1] === "*") {
                boot = true;
                sector_start = parseInt(line[2]);
                sector_stop = parseInt(line[3]);
                sectors = parseInt(line[4]);
                typeId = parseInt(line[6]);
                for (var l = 7; l < line.length; l++) {
                    if (l === line.length - 1) {
                        type = type + line[l];
                    }
                    else {
                        type = type + line[l] + " ";
                    }
                }
            }
            else {
                boot = false;
                sector_start = parseInt(line[1]);
                sector_stop = parseInt(line[2]);
                sectors = parseInt(line[3]);
                typeId = parseInt(line[5]);
                for (var l = 6; l < line.length; l++) {
                    if (l === line.length - 1) {
                        type = type + line[l];
                    }
                    else {
                        type = type + line[l] + " ";
                    }
                }
            }
            var size = disks[disks.length - 1].block * sectors;
            disks[disks.length - 1].partitions.push({ partition: partition, sectors_start: sector_start, sectors_stop: sector_stop, sectors: sectors, size: size, type: type, boot: boot });
        }
        else if (disks[0] && line[0] === "Units:") {
            disks[disks.length - 1].block = parseInt(line[5]);
        }
    }
    for (var i = 0; i < disks.length; i++) {
        if (disks[i].partitions.length > 0) {
            disks[i].used_blocks = disks[i].partitions[disks[i].partitions.length - 1].sectors_stop;
        }
    }
    return disks;
}
exports.all = all;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbImRldmljZSIsImFsbCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSSxRQUFRLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBeUJwQyxnQkFBdUIsTUFBYztJQUNqQ0EsSUFBSUEsR0FBR0EsR0FBR0EsUUFBUUEsR0FBR0EsTUFBTUEsR0FBR0EsS0FBS0EsQ0FBQ0E7SUFFcENBLElBQUlBLEdBQUdBLEdBQUdBLFFBQVFBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLENBQUNBO0lBQzNDQSxJQUFJQSxLQUFLQSxHQUFZQSxFQUFFQSxDQUFDQTtJQUN4QkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0E7UUFDbENBLElBQUlBLElBQUlBLEdBQWFBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLFVBQVVBLEVBQUVBLEVBQUVBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQy9EQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxVQUFVQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUUxRUEsSUFBSUEsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsRUFBRUEsRUFBRUEsQ0FBQ0EsQ0FBQ0E7WUFDcENBLElBQUlBLE9BQU9BLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ2hDQSxJQUFJQSxJQUFJQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUM3QkEsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsT0FBT0EsRUFBRUEsT0FBT0EsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsVUFBVUEsRUFBZ0JBLEVBQUVBLEVBQUVBLEtBQUtBLEVBQUVBLEdBQUdBLEVBQUVBLFdBQVdBLEVBQUNBLElBQUlBLEVBQUVBLENBQUNBLENBQUNBO1FBQ3pIQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUV4R0EsSUFBSUEsU0FBU0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDeEJBLElBQUlBLElBQUlBLFNBQUFBLENBQUNBO1lBQ1RBLElBQUlBLFlBQVlBLFNBQUFBLENBQUNBO1lBQ2pCQSxJQUFJQSxXQUFXQSxTQUFBQSxDQUFDQTtZQUNoQkEsSUFBSUEsT0FBT0EsU0FBQUEsQ0FBQ0E7WUFFWkEsSUFBSUEsSUFBSUEsR0FBR0EsRUFBRUEsQ0FBQ0E7WUFDZEEsSUFBSUEsTUFBTUEsU0FBQUEsQ0FBQ0E7WUFFWEEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FB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QUFJQSxFQUFFQSxJQUFJQSxFQUFFQSxJQUFJQSxFQUFFQSxJQUFJQSxFQUFFQSxJQUFJQSxFQUFFQSxJQUFJQSxFQUFFQSxDQUFDQSxDQUFDQTtRQUNwTEEsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDMUNBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1FBQ3REQSxDQUFDQTtJQUNMQSxDQUFDQTtJQUNEQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxXQUFXQSxHQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxVQUFVQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxVQUFVQSxDQUFDQSxNQUFNQSxHQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxZQUFZQSxDQUFDQTtJQUVwRkEsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7QUFFcEJBLENBQUNBO0FBOURlLGNBQU0sU0E4RHJCLENBQUE7QUFFRDtJQUVRQyxJQUFJQSxHQUFHQSxHQUFHQSxVQUFVQSxDQUFDQTtJQUN6QkEsSUFBSUEsR0FBR0EsR0FBR0EsUUFBUUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7SUFDM0NBLElBQUlBLEtBQUtBLEdBQVlBLEVBQUVBLENBQUNBO0lBQ3hCQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxHQUFHQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQSxFQUFFQSxFQUFFQSxDQUFDQTtRQUNsQ0EsSUFBSUEsSUFBSUEsR0FBYUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsVUFBVUEsRUFBRUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDL0RBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLFVBQVVBLENBQUNBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLElBQUlBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRTFFQSxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxPQUFPQSxDQUFDQSxHQUFHQSxFQUFFQSxFQUFFQSxDQUFDQSxDQUFDQTtZQUNwQ0EsSUFBSUEsT0FBT0EsR0FBR0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDaENBLElBQUlBLElBQUlBLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQzdCQSxLQUFLQSxDQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxJQUFJQSxFQUFFQSxJQUFJQSxFQUFFQSxPQUFPQSxFQUFFQSxPQUFPQSxFQUFFQSxJQUFJQSxFQUFFQSxJQUFJQSxFQUFFQSxVQUFVQSxFQUFnQkEsRUFBRUEsRUFBRUEsS0FBS0EsRUFBRUEsR0FBR0EsRUFBRUEsV0FBV0EsRUFBQ0EsSUFBSUEsRUFBRUEsQ0FBQ0EsQ0FBQ0E7UUFDekhBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLElBQUlBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRXhHQSxJQUFJQSxTQUFTQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN4QkEsSUFBSUEsSUFBSUEsU0FBQUEsQ0FBQ0E7WUFDVEEsSUFBSUEsWUFBWUEsU0FBQUEsQ0FBQ0E7WUFDakJBLElBQUlBLFdBQVdBLFNBQUFBLENBQUNBO1lBQ2hCQSxJQUFJQSxPQUFPQSxTQUFBQSxDQUFDQTtZQUVaQSxJQUFJQSxJQUFJQSxHQUFHQSxFQUFFQSxDQUFDQTtZQUNkQSxJQUFJQSxNQUFNQSxTQUFBQSxDQUFDQTtZQUVYQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDbEJBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBO2dCQUNaQSxZQUFZQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDakNBLFdBQVdBLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUNoQ0EsT0FBT0EsR0FBR0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzVCQSxNQUFNQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDM0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO29CQUNuQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7d0JBQ3hCQSxJQUFJQSxHQUFHQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDMUJBLENBQUNBO29CQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTt3QkFDSkEsSUFBSUEsR0FBR0EsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0E7b0JBQ2hDQSxDQUFDQTtnQkFDTEEsQ0FBQ0E7WUFFTEEsQ0FBQ0E7WUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ0pBLElBQUlBLEdBQUdBLEtBQUtBLENBQUNBO2dCQUNiQSxZQUFZQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDakNBLFdBQVdBLEdBQUdBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUNoQ0EsT0FBT0EsR0FBR0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzVCQSxNQUFNQSxHQUFHQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDM0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO29CQUNuQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7d0JBQ3hCQSxJQUFJQSxHQUFHQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDMUJBLENBQUNBO29CQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTt3QkFDSkEsSUFBSUEsR0FBR0EsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0E7b0JBQ2hDQSxDQUFDQTtnQkFDTEEsQ0FBQ0E7WUFDTEEsQ0FBQ0E7WUFDREEsSUFBSUEsSUFBSUEsR0FBR0EsS0FBS0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsR0FBR0EsT0FBT0EsQ0FBQ0E7WUFDbkRBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLEVBQUVBLFNBQVNBLEVBQUVBLFNBQVNBLEVBQUVBLGFBQWFBLEVBQUVBLFlBQVlBLEVBQUVBLFlBQVlBLEVBQUVBLFdBQVdBLEVBQUVBLE9BQU9BLEVBQUVBLE9BQU9BLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLENBQUNBLENBQUNBO1FBQ3BMQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUMxQ0EsS0FBS0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsR0FBR0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDdERBLENBQUNBO0lBQ0xBLENBQUNBO0lBR0xBLEdBQUdBLENBQUFBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEVBQUNBLENBQUNBLEdBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEVBQUNBLENBQUNBLEVBQUVBLEVBQUNBLENBQUNBO1FBQzVCQSxFQUFFQSxDQUFBQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxVQUFVQSxDQUFDQSxNQUFNQSxHQUFDQSxDQUFDQSxDQUFDQSxDQUFBQSxDQUFDQTtZQUNqQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsV0FBV0EsR0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsVUFBVUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsVUFBVUEsQ0FBQ0EsTUFBTUEsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsWUFBWUEsQ0FBQ0E7UUFDcEZBLENBQUNBO0lBQ0xBLENBQUNBO0lBRUdBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBO0FBQ2pCQSxDQUFDQTtBQW5FZSxXQUFHLE1BbUVsQixDQUFBIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IGV4ZWNTeW5jID0gcmVxdWlyZShcInN5bmMtZXhlY1wiKTtcblxuXG5pbnRlcmZhY2UgSVBhcnRpdGlvbiB7XG4gICAgcGFydGl0aW9uOiBzdHJpbmc7XG4gICAgc2VjdG9yczogbnVtYmVyO1xuICAgIHNlY3RvcnNfc3RhcnQ6IG51bWJlcjtcbiAgICBzZWN0b3JzX3N0b3A6IG51bWJlcjtcbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgYm9vdDogYm9vbGVhbjtcbiAgICBzaXplOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBJRGlzayB7XG4gICAgZGlzazogc3RyaW5nO1xuICAgIHNlY3RvcnM6IG51bWJlcjtcbiAgICBzaXplOiBudW1iZXI7XG4gICAgcGFydGl0aW9uczogSVBhcnRpdGlvbltdO1xuICAgIGJsb2NrOiBudW1iZXI7XG4gICAgdXNlZF9ibG9ja3M6bnVtYmVyO1xufVxuXG5cblxuXG5leHBvcnQgZnVuY3Rpb24gZGV2aWNlKGRldmljZTogc3RyaW5nKSB7XG4gICAgbGV0IGNtZCA9IFwiZmRpc2sgXCIgKyBkZXZpY2UgKyBcIiAtbFwiO1xuXG4gICAgbGV0IGZkaSA9IGV4ZWNTeW5jKGNtZCkuc3Rkb3V0LnNwbGl0KFwiXFxuXCIpO1xuICAgIGxldCBkaXNrcyA9IDxJRGlza1tdPltdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmRpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBsaW5lOiBzdHJpbmdbXSA9IGZkaVtpXS5yZXBsYWNlKC8gKyg/PSApL2csIFwiXCIpLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgaWYgKGZkaVtpXS5zcGxpdChcIi9kZXYvcmFtXCIpLmxlbmd0aCA8IDIgJiYgZmRpW2ldLnNwbGl0KFwiaXNrIC9cIikubGVuZ3RoID4gMSkge1xuXG4gICAgICAgICAgICBsZXQgZGlzayA9IGxpbmVbMV0ucmVwbGFjZShcIjpcIiwgXCJcIik7XG4gICAgICAgICAgICBsZXQgc2VjdG9ycyA9IHBhcnNlSW50KGxpbmVbNl0pO1xuICAgICAgICAgICAgbGV0IHNpemUgPSBwYXJzZUludChsaW5lWzRdKTtcbiAgICAgICAgICAgIGRpc2tzLnB1c2goeyBkaXNrOiBkaXNrLCBzZWN0b3JzOiBzZWN0b3JzLCBzaXplOiBzaXplLCBwYXJ0aXRpb25zOiA8SVBhcnRpdGlvbltdPltdLCBibG9jazogNTEyLCB1c2VkX2Jsb2NrczpudWxsIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGRpc2tzWzBdICYmIGZkaVtpXS5zcGxpdChcIjpcIikubGVuZ3RoIDwgMiAmJiBmZGlbaV0uc3BsaXQoXCJkZXYvXCIpLmxlbmd0aCA+IDEgJiYgbGluZS5sZW5ndGggPiAxKSB7XG5cbiAgICAgICAgICAgIGxldCBwYXJ0aXRpb24gPSBsaW5lWzBdO1xuICAgICAgICAgICAgbGV0IGJvb3Q7XG4gICAgICAgICAgICBsZXQgc2VjdG9yX3N0YXJ0O1xuICAgICAgICAgICAgbGV0IHNlY3Rvcl9zdG9wO1xuICAgICAgICAgICAgbGV0IHNlY3RvcnM7XG5cbiAgICAgICAgICAgIGxldCB0eXBlID0gXCJcIjtcbiAgICAgICAgICAgIGxldCB0eXBlSWQ7XG5cbiAgICAgICAgICAgIGlmIChsaW5lWzFdID09PSBcIipcIikge1xuICAgICAgICAgICAgICAgIGJvb3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNlY3Rvcl9zdGFydCA9IHBhcnNlSW50KGxpbmVbMl0pO1xuICAgICAgICAgICAgICAgIHNlY3Rvcl9zdG9wID0gcGFyc2VJbnQobGluZVszXSk7XG4gICAgICAgICAgICAgICAgc2VjdG9ycyA9IHBhcnNlSW50KGxpbmVbNF0pO1xuICAgICAgICAgICAgICAgIHR5cGVJZCA9IHBhcnNlSW50KGxpbmVbNl0pO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGwgPSA3OyBsIDwgbGluZS5sZW5ndGg7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobCA9PT0gbGluZS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gdHlwZSArIGxpbmVbbF07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gdHlwZSArIGxpbmVbbF0gKyBcIiBcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBib290ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgc2VjdG9yX3N0YXJ0ID0gcGFyc2VJbnQobGluZVsxXSk7XG4gICAgICAgICAgICAgICAgc2VjdG9yX3N0b3AgPSBwYXJzZUludChsaW5lWzJdKTtcbiAgICAgICAgICAgICAgICBzZWN0b3JzID0gcGFyc2VJbnQobGluZVszXSk7XG4gICAgICAgICAgICAgICAgdHlwZUlkID0gcGFyc2VJbnQobGluZVs1XSk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbCA9IDY7IGwgPCBsaW5lLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsID09PSBsaW5lLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlICsgbGluZVtsXTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlICsgbGluZVtsXSArIFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHNpemUgPSBkaXNrc1tkaXNrcy5sZW5ndGggLSAxXS5ibG9jayAqIHNlY3RvcnM7XG4gICAgICAgICAgICBkaXNrc1tkaXNrcy5sZW5ndGggLSAxXS5wYXJ0aXRpb25zLnB1c2goeyBwYXJ0aXRpb246IHBhcnRpdGlvbiwgc2VjdG9yc19zdGFydDogc2VjdG9yX3N0YXJ0LCBzZWN0b3JzX3N0b3A6IHNlY3Rvcl9zdG9wLCBzZWN0b3JzOiBzZWN0b3JzLCBzaXplOiBzaXplLCB0eXBlOiB0eXBlLCBib290OiBib290IH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGRpc2tzWzBdICYmIGxpbmVbMF0gPT09IFwiVW5pdHM6XCIpIHtcbiAgICAgICAgICAgIGRpc2tzW2Rpc2tzLmxlbmd0aCAtIDFdLmJsb2NrID0gcGFyc2VJbnQobGluZVs1XSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlza3NbMF0udXNlZF9ibG9ja3M9ZGlza3NbMF0ucGFydGl0aW9uc1tkaXNrc1swXS5wYXJ0aXRpb25zLmxlbmd0aC0xXS5zZWN0b3JzX3N0b3A7XG5cbiAgICByZXR1cm4gZGlza3NbMF07XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFsbCgpIHtcblxuICAgICAgICBsZXQgY21kID0gXCJmZGlzayAtbFwiO1xuICAgIGxldCBmZGkgPSBleGVjU3luYyhjbWQpLnN0ZG91dC5zcGxpdChcIlxcblwiKTtcbiAgICBsZXQgZGlza3MgPSA8SURpc2tbXT5bXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZkaS5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgbGluZTogc3RyaW5nW10gPSBmZGlbaV0ucmVwbGFjZSgvICsoPz0gKS9nLCBcIlwiKS5zcGxpdChcIiBcIik7XG4gICAgICAgIGlmIChmZGlbaV0uc3BsaXQoXCIvZGV2L3JhbVwiKS5sZW5ndGggPCAyICYmIGZkaVtpXS5zcGxpdChcImlzayAvXCIpLmxlbmd0aCA+IDEpIHtcblxuICAgICAgICAgICAgbGV0IGRpc2sgPSBsaW5lWzFdLnJlcGxhY2UoXCI6XCIsIFwiXCIpO1xuICAgICAgICAgICAgbGV0IHNlY3RvcnMgPSBwYXJzZUludChsaW5lWzZdKTtcbiAgICAgICAgICAgIGxldCBzaXplID0gcGFyc2VJbnQobGluZVs0XSk7XG4gICAgICAgICAgICBkaXNrcy5wdXNoKHsgZGlzazogZGlzaywgc2VjdG9yczogc2VjdG9ycywgc2l6ZTogc2l6ZSwgcGFydGl0aW9uczogPElQYXJ0aXRpb25bXT5bXSwgYmxvY2s6IDUxMiwgdXNlZF9ibG9ja3M6bnVsbCB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChkaXNrc1swXSAmJiBmZGlbaV0uc3BsaXQoXCI6XCIpLmxlbmd0aCA8IDIgJiYgZmRpW2ldLnNwbGl0KFwiZGV2L1wiKS5sZW5ndGggPiAxICYmIGxpbmUubGVuZ3RoID4gMSkge1xuXG4gICAgICAgICAgICBsZXQgcGFydGl0aW9uID0gbGluZVswXTtcbiAgICAgICAgICAgIGxldCBib290O1xuICAgICAgICAgICAgbGV0IHNlY3Rvcl9zdGFydDtcbiAgICAgICAgICAgIGxldCBzZWN0b3Jfc3RvcDtcbiAgICAgICAgICAgIGxldCBzZWN0b3JzO1xuXG4gICAgICAgICAgICBsZXQgdHlwZSA9IFwiXCI7XG4gICAgICAgICAgICBsZXQgdHlwZUlkO1xuXG4gICAgICAgICAgICBpZiAobGluZVsxXSA9PT0gXCIqXCIpIHtcbiAgICAgICAgICAgICAgICBib290ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzZWN0b3Jfc3RhcnQgPSBwYXJzZUludChsaW5lWzJdKTtcbiAgICAgICAgICAgICAgICBzZWN0b3Jfc3RvcCA9IHBhcnNlSW50KGxpbmVbM10pO1xuICAgICAgICAgICAgICAgIHNlY3RvcnMgPSBwYXJzZUludChsaW5lWzRdKTtcbiAgICAgICAgICAgICAgICB0eXBlSWQgPSBwYXJzZUludChsaW5lWzZdKTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBsID0gNzsgbCA8IGxpbmUubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGwgPT09IGxpbmUubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IHR5cGUgKyBsaW5lW2xdO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IHR5cGUgKyBsaW5lW2xdICsgXCIgXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYm9vdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHNlY3Rvcl9zdGFydCA9IHBhcnNlSW50KGxpbmVbMV0pO1xuICAgICAgICAgICAgICAgIHNlY3Rvcl9zdG9wID0gcGFyc2VJbnQobGluZVsyXSk7XG4gICAgICAgICAgICAgICAgc2VjdG9ycyA9IHBhcnNlSW50KGxpbmVbM10pO1xuICAgICAgICAgICAgICAgIHR5cGVJZCA9IHBhcnNlSW50KGxpbmVbNV0pO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGwgPSA2OyBsIDwgbGluZS5sZW5ndGg7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobCA9PT0gbGluZS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gdHlwZSArIGxpbmVbbF07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gdHlwZSArIGxpbmVbbF0gKyBcIiBcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBzaXplID0gZGlza3NbZGlza3MubGVuZ3RoIC0gMV0uYmxvY2sgKiBzZWN0b3JzO1xuICAgICAgICAgICAgZGlza3NbZGlza3MubGVuZ3RoIC0gMV0ucGFydGl0aW9ucy5wdXNoKHsgcGFydGl0aW9uOiBwYXJ0aXRpb24sIHNlY3RvcnNfc3RhcnQ6IHNlY3Rvcl9zdGFydCwgc2VjdG9yc19zdG9wOiBzZWN0b3Jfc3RvcCwgc2VjdG9yczogc2VjdG9ycywgc2l6ZTogc2l6ZSwgdHlwZTogdHlwZSwgYm9vdDogYm9vdCB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChkaXNrc1swXSAmJiBsaW5lWzBdID09PSBcIlVuaXRzOlwiKSB7XG4gICAgICAgICAgICBkaXNrc1tkaXNrcy5sZW5ndGggLSAxXS5ibG9jayA9IHBhcnNlSW50KGxpbmVbNV0pO1xuICAgICAgICB9XG4gICAgfVxuXG5cbmZvcihsZXQgaT0wO2k8ZGlza3MubGVuZ3RoO2krKyl7XG4gICAgaWYoZGlza3NbaV0ucGFydGl0aW9ucy5sZW5ndGg+MCl7XG4gICAgZGlza3NbaV0udXNlZF9ibG9ja3M9ZGlza3NbaV0ucGFydGl0aW9uc1tkaXNrc1tpXS5wYXJ0aXRpb25zLmxlbmd0aC0xXS5zZWN0b3JzX3N0b3A7XG4gICAgfVxufVxuXG4gICAgcmV0dXJuIGRpc2tzO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
